# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Описание данных
**Товар**
- IProduct - содержит в себе название товара(title), изображение товара(image), цену(price), категорию (category), описание товара(description), айди карточки товара(id).

**Данные пользователя**
- IOrder - содежит в себе способ оплаты товара, который выбрал пользователь(payment), данные адреса(address), почты(email), номер телефона(phone).

**Корзина**
- ICart - содержит в себе массив карточек товаров, которые добавил пользователь(items), сумму выбранных товаров(total).

**Каталог**
- ICatalog - каталог товаров состоит из массива всех карточек товаров(items).

**Статус оформления заказа**
- IOrderStatus - включает в себя информацию о том успешно ли оформлен заказ или нет(isComplete), сумму валюты, списанной со счёта(total).

**Интерфейс API-клиента**
- IApi - запрос у сервера всех продуктов(getProducts) и отправляет запрос на формирование заказа (orderProducts)

## Архитектура приложения
Код приложения разделен на слои согласно парадигме MVP:

- слой представления(view), отвечающий за отображение данных,
- слой данных(model), отвечающий за хранение и изменение данных,
- презентер(presenter), отвечающий за связь представления и данных.
## Базовый код

**Класс EventEmitter** 
обеспечивает работу событий c создаёт функцию-коллбэк, которая при вызове генерирует событие с заданным именем возможностью установить и снять слушателей событий, вызвать слушателей при возникновении события.
Его методы:
- on - устанавливает обработчик на событие.
- off - снимает обработчик с события.
- emit - инициализация события.
- onAll - подписка на все события.
- offAll - сбросить все обработчики событий.
- trigger - создаёт функцию-коллбэк, которая при вызове генерирует событие с заданными параметрами.

**Класс Api**
обеспечивает взаимодействие HTTP-запросов с веб-API - отправляет запросы и обрабатывает ответы. 
Его методы: 
- get - принимает изменяющеюся часть url-адреса, выполняет GET-запрос по указанному uri и возвращает ответ в виде Promise.
- post - принимает изменяющеюся часть url-адреса, данные в виде объекта, выполняет POST-запрос или другой запрос, указанный в параметре method, возвращает ответ в виде Promise.

## Слой данных (model)

**Класс ProductModel**
Для хранения и управления данными в каталоге.
Его методы:
- getAllProducts(): IProduct[] — Возвращает массив всех товаров из каталога.
- getProductById(id: string): IProduct | null — Возвращает информацию о товаре по его id или null, если товар не найден.
- addProduct(product: IProduct): void — Добавляет новый товар в каталог.
- removeProduct(id: string): void — Удаляет товар из каталога по id.

**Класс CartModel**
Для управления корзиной, хранения списка товаров и общей суммы.
- getCartItems(): IProduct[] — Возвращает массив товаров, добавленных в корзину.
- addToCart(productId: string): void — Добавляет товар в корзину по id. 
- removeFromCart(productId: string): void — Удаляет товар из корзины по id.
- clearCart(): void — Очищает корзину после завершения покупки.
- calculateTotal(): number — Возвращает общую сумму товаров в корзине, используя их цены.
- isProductAdded(productId: string): boolean - проверяет добавлен ли товар в корзину, возвращает булево значение.

**Класс OrderModel**
Для управления данными пользователя для заказа.
- setDeliveryAddress(address: string): void — Устанавливает адрес доставки для заказа.
- setPaymentMethod(payment: Payment): void — Устанавливает способ оплаты.
- setContactInfo(email: string, phone: string): void — Устанавливает контактную информацию пользователя.
- validateAddress(): boolean — Проверка на корректность адреса. Возвращает true - адрес корректен, false — адрес не корректный.
- validateContactInfo(): boolean — Проверка на корректность контактных данных (почты и телефона). Возвращает true - корректны.
- confirmOrder(): boolean — Подтверждает заказ, очищает корзину и возвращает true, если заказ оформлен успешно.

## Слой представления(view)

**Класс CatalogView**
Отображает главную страницу каталога со всеми товарами.
Его методы:
-renderCatalog(items: IProduct[]): void — Отображает список товаров в каталоге.

**Класс Modal**
Базовый класс для всех модальных окон, реализующий методы открытия, закрытия окна.
Его методы:
- open(content: HTMLElement): void — Открывает модальное окно.
- close(): void — Закрывает модальное окно.

**Класс Button**
Базовый класс для всех кнопок, обеспечивает обработку событий клика.
- bindClick(handler: () => void): void — Связывает кнопку с функцией handler.

**Класс CartView**
Отображает содержимое корзины и управление товарами, включая возможность удаления товара и оформление заказа.
Методы:
- renderCart(items: IProduct[], total: number): void — Отображает список товаров в корзине и общую сумму.
- updateTotal(total: number): void — Обновляет общую сумму корзины после добавления или удаления товаров.

**Класс ProductView**
Отображает модальное окно с детальной информацией о товаре, а также кнопками добавления или удаления товара из корзины.
Методы:
- renderProductDetails(product: IProduct): void — Отображает детальную информацию о товаре (изображение, название, описание и цена).

**Класс ContactsFormView**
Отображает форму ввода контактной информации покупателя, проверяет корректность данных перед отправкой.
Методы:
- renderForm(): void — Отображает форму с полями ввода почты и телефона.
- clearForm(): void — Очищает форму после успешной отправки контактных данных.

**Класс OrderFormView**
Управляет отображением шагов оформления заказа, включая ввод адреса и выбор способа оплаты.
Методы:
- renderForm(): void — Отображает форму с полями ввода адреса и способа доставки.
- clearForm(): void — Очищает форму после завершения оформления заказа.

**Класс SuccessView**
Отображает окно подтверждения успешного завершения покупки и позволяет вернуться в каталог.
Методы:
- renderSuccessMessage(orderId: string): void — Отображает сообщение об успешной покупке.

**Класс PageView**
Базовый класс для управления основными страницами приложения.
Методы:
- renderPage(content: HTMLElement): void — Отображает переданный контент на основной странице.

## Презентер(presenter)

**Класс CatalogPresenter**
Управляет логикой отображения каталога товаров и взаимодействиями, связанными с каталогом (например, открытием карточки товара).
Конструктор принимает ProductModel и CatalogView.
Его методы:
- initialize(): void — Инициализирует каталог, запрашивая список товаров из ProductModel и передавая его в CatalogView для отображения.
- handleOpenProductModal(productId: string): void — Обработчик открытия модального окна с информацией о выбранном товаре.

**Класс CartPresenter**
Управляет отображением и функциями корзины, включая добавление и удаление товаров, расчет общей суммы и переход к оформлению заказа.
Конструктор принимает Modal, CartModel, и OrderModel.
Его методы:
- initialize(): void — Инициализирует корзину, получая список товаров и общую сумму из CartModel и передавая их в Modal для отображения.
- handleRemoveFromCart(productId: string): void — Удаляет товар из корзины через CartModel и обновляет отображение корзины.
- handleProceedToCheckout(): void — Переходит к оформлению заказа, вызывая метод CheckoutPresenter и инициализируя окно оформления заказа.

**Класс CheckoutPresenter**
Управляет процессом оформления заказа, включая выбор способа оплаты и ввод контактных данных, проверку их корректности и завершение покупки.
Конструктор принимает экземпляры Modal, OrderModel, и CartModel.
Его методы:
- initialize(): void — Подготавливает форму оформления заказа.
- handleSetDeliveryAddress(address: string): void — Устанавливает адрес доставки через OrderModel.
- handleSetPaymentMethod(payment: Payment): void — Устанавливает способ оплаты, используя значение типа Payment.
- handleSetContactInfo(email: string, phone: string): void — Устанавливает контактные данные покупателя через OrderModel.
- validateAddress(): boolean — Проверяет корректность введенного адреса через OrderModel и возвращает результат проверки.
- validateContactInfo(): boolean — Проверяет корректность контактной информации и отображает ошибки, если они есть.
- handleNextStep(): void — Переходит к следующему шагу оформления заказа, если текущие данные корректны.
- handleConfirmOrder(): void — Завершает оформление заказа, очищает корзину и показывает модальное окно с сообщением об успешной покупке.